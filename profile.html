<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>My Profile</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(to right, #e0f7fa, #fff);
    margin: 0;
  }
  header {
    background: linear-gradient(90deg, #00796b, #004d40);
    padding: 20px;
    color: white;
    text-align: center;
    font-size: 1.8em;
    font-weight: bold;
  }
  nav {
    background: #004d40;
    padding: 10px;
    display: flex;
    justify-content: center;
    gap: 20px;
  }
  nav a {
    color: white;
    text-decoration: none;
    font-weight: bold;
    padding: 8px 12px;
    border-radius: 4px;
    transition: background 0.3s ease;
  }
  nav a:hover {
    background: rgba(255,255,255,0.2);
  }
  .container {
    display: flex;
    justify-content: center;
    gap: 40px;
    padding: 30px;
  }
  .card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    width: 350px;
  }
  h2 {
    color: #004d40;
    margin-bottom: 20px;
  }
  input, textarea {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 1em;
  }
  button {
    background: #00796b;
    color: white;
    padding: 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 1em;
    margin-top: 10px;
    width: 100%;
  }
  button:hover {
    background: #004d40;
  }
  .profile-pic {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid #004d40;
    margin-bottom: 15px;
  }
  .info p {
    margin: 6px 0;
    font-size: 1.05em;
    color: #333;
  }
  .gender-select {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin: 10px 0;
  }
  .gender-option {
    cursor: pointer;
    border: 2px solid transparent;
    border-radius: 50%;
    padding: 5px;
    transition: border 0.3s ease;
  }
  .gender-option img {
    width: 60px;
    height: 60px;
    border-radius: 50%;
  }
  .gender-option.selected {
    border: 2px solid #00796b;
  }
</style>
</head>
<body>

<header>My Profile</header>
<nav>
  <a href="index.html">Home</a>
  <a href="doctors.html">Doctors</a>
  <a href="appointments.html">Appointments</a>
  <a href="profile.html">Profile</a>
  <a href="history.html">Medical History</a>
</nav>

<div class="container">
  <!-- Form Card -->
  <div class="card" id="formCard">
    <h2>Fill Your Information</h2>
    <input type="text" id="fullName" placeholder="Full Name" required>
    <input type="text" id="patientId" placeholder="Patient ID" required>
    <input type="email" id="email" placeholder="Email" required>
    <input type="tel" id="phone" placeholder="Phone Number" required>
    <input type="date" id="dob" required>
    <textarea id="address" placeholder="Address" rows="3" required></textarea>
    
    <p style="margin-top:10px; font-weight:bold;">Select Gender:</p>
    <div class="gender-select">
      <div class="gender-option" data-gender="male">
        <img src="male.png" alt="Male">
      </div>
      <div class="gender-option" data-gender="female">
        <img src="female.png" alt="Female">
      </div>
    </div>
    
    <input type="url" id="photoUrl" placeholder="Profile Photo URL (optional)">
    <button onclick="saveProfile()">Save Profile</button>
  </div>

  <!-- Profile Card -->
  <div class="card" id="profileCard" style="display:none; text-align:center;">
    <img id="displayPhoto" src="" alt="Profile Picture" class="profile-pic">
    <h2 id="displayName"></h2>
    <div class="info">
      <p><strong>Patient ID:</strong> <span id="displayPatientId"></span></p>
      <p><strong>Email:</strong> <span id="displayEmail"></span></p>
      <p><strong>Phone:</strong> <span id="displayPhone"></span></p>
      <p><strong>Date of Birth:</strong> <span id="displayDob"></span></p>
      <p><strong>Address:</strong> <span id="displayAddress"></span></p>
      <button onclick="editProfile()" style="margin-top:15px; background:#00796b;">Edit Profile</button>
    </div>
  </div>
</div>

<script>
  let selectedGender = null;

  // Load saved profile from localStorage
  window.onload = function() {
    const savedProfile = JSON.parse(localStorage.getItem("profile"));
    if (savedProfile) {
      selectedGender = savedProfile.gender || null;
      showProfile(savedProfile);
    }
  };

  // Gender selection
  document.querySelectorAll('.gender-option').forEach(option => {
    option.addEventListener('click', () => {
      document.querySelectorAll('.gender-option').forEach(opt => opt.classList.remove('selected'));
      option.classList.add('selected');
      selectedGender = option.getAttribute('data-gender');
    });
  });

  function saveProfile() {
    const name = document.getElementById("fullName").value;
    const patientId = document.getElementById("patientId").value;
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    const dob = document.getElementById("dob").value;
    const address = document.getElementById("address").value;
    const photoUrl = document.getElementById("photoUrl").value;

    if (!name || !patientId || !email || !phone || !dob || !address) {
      alert("Please fill in all required fields.");
      return;
    }

    // Determine profile photo
    let finalPhoto = "";
    if (photoUrl) {
      finalPhoto = photoUrl;
    } else {
      if (selectedGender === "male") finalPhoto = "male.png";
      else if (selectedGender === "female") finalPhoto = "female.png";
      else finalPhoto = "default.png";
    }

    const profileData = {
      name,
      patientId,
      email,
      phone,
      dob,
      address,
      gender: selectedGender,
      photo: finalPhoto
    };

    // Save to localStorage
    localStorage.setItem("profile", JSON.stringify(profileData));

    showProfile(profileData);
  }

  function showProfile(profile) {
    document.getElementById("displayName").innerText = profile.name;
    document.getElementById("displayPatientId").innerText = profile.patientId;
    document.getElementById("displayEmail").innerText = profile.email;
    document.getElementById("displayPhone").innerText = profile.phone;
    document.getElementById("displayDob").innerText = profile.dob;
    document.getElementById("displayAddress").innerText = profile.address;
    document.getElementById("displayPhoto").src = profile.photo;

    // Hide form & show profile card
    document.getElementById("formCard").style.display = "none";
    document.getElementById("profileCard").style.display = "block";

    // Highlight selected gender in form if needed
    document.querySelectorAll('.gender-option').forEach(opt => {
      opt.classList.remove('selected');
      if (opt.getAttribute('data-gender') === profile.gender) {
        opt.classList.add('selected');
      }
    });
  }

  // Edit Profile function
  function editProfile() {
    const savedProfile = JSON.parse(localStorage.getItem("profile"));
    if (!savedProfile) return;

    // Pre-fill form fields
    document.getElementById("fullName").value = savedProfile.name;
    document.getElementById("patientId").value = savedProfile.patientId;
    document.getElementById("email").value = savedProfile.email;
    document.getElementById("phone").value = savedProfile.phone;
    document.getElementById("dob").value = savedProfile.dob;
    document.getElementById("address").value = savedProfile.address;
    document.getElementById("photoUrl").value = savedProfile.photo !== "male.png" && savedProfile.photo !== "female.png" && savedProfile.photo !== "default.png" ? savedProfile.photo : "";

    selectedGender = savedProfile.gender;

    // Highlight gender selection
    document.querySelectorAll('.gender-option').forEach(opt => {
      opt.classList.remove('selected');
      if (opt.getAttribute('data-gender') === selectedGender) {
        opt.classList.add('selected');
      }
    });

    // Show form and hide profile card
    document.getElementById("formCard").style.display = "block";
    document.getElementById("profileCard").style.display = "none";
  }

  // Optional: Logout function to clear profile
  function logout() {
    localStorage.removeItem("profile");
    document.getElementById("formCard").style.display = "block";
    document.getElementById("profileCard").style.display = "none";
    selectedGender = null;
  }
</script>
</body>
</html>
